<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
<script>
// var a = 'tony'
// var obj = {
//   a: 'allen'
// }
//
// function fn (b, c) {
//   console.log(this.a + `-${b}-${c}`)
// }
//
// // call,apply会动态绑定this，并会立即执行
// fn.call(obj, 2, 3)  // allen-2-3
// fn(2, 3)  // tony-2-3
// fn.call() // tony
// fn.call(null, 2, 3) // tony-2-3
// fn.call(undefined, 2, 3)  // tony-2-3
// fn.call(window, 2, 3) // tony-2-3
// fn.apply(obj, [ 2, 3 ]) // allen-2-3
//
// // 使用
// // 类数组转换成数组
// console.log(Array.prototype.slice.call({ 0: 2, 1: 3, length: 2 }))  // [2,3]
// console.log(Object.prototype.toString.call({})) // [object Object]
//
// let f = fn.bind(obj, 5)
// f(3, 4) // allen-5-3
// let f1 = fn.bind(obj)
// f1(6, 7)  // allen-6-7


var a = 'tony'
var obj = {
  a: 'allen'
}

function fn (b, c) {
  console.log(this.a + `-${b}-${c}`)
}


let f = fn.bind(obj, 1)
f(2)


Function.prototype.bind1 = function (context) {
  let _this = this
  let args = Array.prototype.slice.call(arguments, 1)
  return function () {
    let args1 = Array.prototype.slice.call(arguments)
    _this.apply(context, args.concat(args1))
  }
}

let f1 = fn.bind1(obj,3)
f1(3)


// Function.prototype.call2 = function (context) {
//   // 处理绑定为空
//   context = context || window
//   context.fn = this
//   // 处理参数
//   let args = []
//   for (let i = 1; i < arguments.length; i++) {
//     args.push(arguments[ i ])
//   }
//   args = args.join(',')
//   let res = eval('context.fn(' + args + ')')
//   delete context.fn
//   return res
// }

// fn.call2(obj, 2, 3)

// Function.prototype.apply1 = function (context, args) {
//   let result
//   context = context || window
//   context.fn = this
//   if (args && args.length > 0) {
//     args = args.join(',')
//     result = eval('context.fn(' + args + ')')
//   } else {
//     result = context.fn()
//   }
//   delete context.fn
//   return result
// }
//
// fn.apply1(obj, [ 3, 2 ])


</script>
</body>
</html>